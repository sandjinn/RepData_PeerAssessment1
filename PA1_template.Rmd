---
title: "Reproducible Research: Peer Assessment 1"
output: 
  html_document:
    keep_md: true
---

This report is written as part of the John Hopkins course on Reproducable Research
presented on Coursera. The aim of the assignment is to demonstrate how a large 
data set can be utilized in reproducible research by using literate programming. 
The report is produced using r markdown to present both the r code and the 
results of that code together with the written text into one file that is 
knitted into an html file.

A dataset has been provided as part of the assignment. The data was collected from
a personal activity monitoring device. During the period of October and November
in 2012 the steps taken by an anonymous individual were recorded in 5 minute 
intervals throughout each day.


## Loading and preprocessing the data

The data needed for the assignment is stored in the [github][1] repository
as a zip file. The assignment instructions require that the first two steps
(calcuating the mean for the total daily steps and evaluating the daily activity
pattern) be done on the raw dataset. The third activity involves processing the
data by replacing the NA values.


**Obtaining the data from github**

The first step is to download the zip file into a temporary folder. 
From the temporary folder the .csv file is extracted using unz() to unzip the file.


```{r loadingGit}
    
    dataTemp <- tempfile()

    url1 <- "https://github.com/sandjinn/RepData_PeerAssessment1/blob/master/activity.zip?raw=TRUE"
    
    download.file(url1, dataTemp, mode = "wb")
    
    dataCSV <- read.csv(unz(dataTemp, "activity.csv"))
    
    unlink(dataTemp)
```


## What is mean total number of steps taken per day?

The steps for each day are recorded in 5 minute intervals. In order to calculate
the average (in this case the mean) number of steps per day the total number of steps
taken each day have to be calculated first. 


**Calculate the total number of steps taken per day**

By using the tapply() function the total number of steps per day can be 
calculated using sum.

```{r stepsDay}

    stepsSum <- tapply(dataCSV$steps, dataCSV$date, sum)
```


**Make a histogram of the total number of steps taken each day**

A histogram of the total number of steps taken each day (calculated above) shows 
a fairly normal distribution.

```{r stepsHist}

    hist(stepsSum, main="Histogram of daily step count", 
         xlab="Total number of steps taken per day")

```


**Calculate and report the mean and median of the total number of steps/day**

```{r stepMean}

    smean <- mean(stepsSum, na.rm = TRUE)

```

```{r stepMedian}

    smedian <- median(stepsSum, na.rm = TRUE)

```

The mean value of the total number of steps taken per day is `r smean`.

The median of the total number of steps taken per day is `r smedian`.



## What is the average daily activity pattern?

Since the steps are recorded in 5 minute intervals they can be used to investigate
during which parts of the day the individual was the most active.


**Mean for the steps taken during each interval**

The 5 minute intervals are all numbered. A list of numbered intervals is created
using the unique() function.

The average number of steps (mean) that were taken during each time interval are
calculated using a for loop and the results are saved in a data frame dMeans that
will also be used in the next sections to replace the NA values.

```{r intMean}

    int <- unique(dataCSV$interval)
    dMeans <- data.frame(Interval=integer(), Mean=integer())

    for(i in int) {
    	
    	m <- mean(subset(dataCSV$steps, dataCSV$interval == i), na.rm=TRUE)
    	dMeans[nrow(dMeans) + 1,] = c(i,m)
    
    }

```


**Plotting the daily activity pattern**

The average number of steps in each time interval can best be visualized as a time
series plot.

```{r activityPlot}

    plot(dMeans$Interval, dMeans$Mean, type = "l", xlab = "5 minute time interval", 
         ylab = "Average number of steps", 
         main = "Average number of steps for each time interval")

```

**Interval with the highest average number of steps**

```{r intHighest}

    aveHigh <- max(dMeans$Mean)
    intHigh <- dMeans$Interval[dMeans$Mean == aveHigh]
```

The time series plot above shows a the daily activity patterns of the individual
during these two months. There are very little activity before time interval 500 
while the most activity takes place between time interval 500 and 1800. 

The highest average number of steps, `r aveHigh` were given in interval `r intHigh`


## Imputing missing values



## Are there differences in activity patterns between weekdays and weekends?

[1]: https://github.com/rdpeng/RepData_PeerAssessment1
